% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/LimROTS.r
\name{LimROTS}
\alias{LimROTS}
\title{LimROTS: A Hybrid Method Integrating Empirical Bayes and
Reproducibility-Optimized Statistics for Robust Analysis of Proteomics and
Metabolomics Data}
\usage{
LimROTS(
  x,
  B = 1000,
  K = NULL,
  a1 = NULL,
  a2 = NULL,
  log = TRUE,
  progress = FALSE,
  verbose = TRUE,
  meta.info = NULL,
  cluster = NULL,
  group.name = NULL,
  formula.str = NULL,
  survival = FALSE,
  paired = FALSE,
  n.ROTS = FALSE,
  seed.cl = 1234,
  robust = TRUE,
  trend = TRUE,
  permutating.group = FALSE
)
}
\arguments{
\item{x}{A \code{SummarizedExperiment} object or a matrix where rows
represent features (e.g., genes, proteins) and columns represent samples.
The values should be log-transformed.}

\item{B}{An integer specifying the number of bootstrap iterations.
Default is 1000.}

\item{K}{An optional integer representing the top list size for ranking.
If not specified, it is set to one-fourth of the number of features.}

\item{a1}{Optional numeric value used in the optimization process.
If defined by the user, no optimization occurs.}

\item{a2}{Optional numeric value used in the optimization process.
If defined by the user, no optimization occurs.}

\item{log}{Logical, indicating whether the data is already log-transformed.
Default is \code{TRUE}.}

\item{progress}{Logical, indicating whether to display a progress bar during
bootstrap sampling. Default is \code{FALSE}.}

\item{verbose}{Logical, indicating whether to display messages during the
function's execution. Default is \code{TRUE}.}

\item{meta.info}{A data frame containing sample-level metadata, where each
row corresponds to a sample. It should include the grouping variable
specified in \code{group.name}. If \code{x} is a \code{SummarizedExperiment}
object, \code{meta.info} must be a vector of the metadata needed for the
model to run and can be retrieved using \code{colData()}.}

\item{cluster}{A parallel cluster object for distributed computation,
e.g., created by \code{makeCluster()}. Default is 2.}

\item{group.name}{A string specifying the column in \code{meta.info} that
represents the groups or conditions for comparison.}

\item{formula.str}{A formula string used when covariates are present in meta.
info for modeling. It should include "~ 0 + ..." to exclude the
intercept from the model.}

\item{survival}{Logical, indicating whether to enable survival analysis.
If \code{TRUE}, then \code{meta.info} should contain \code{time} and
\code{event} columns.}

\item{paired}{Logical, indicating whether the data represent paired samples.
'Default is \code{FALSE}.}

\item{n.ROTS}{Logical. If \code{TRUE}, all parameters related to
\code{LimROTS} will be ignored, and the original
\code{ROTS} analysis will run. This must be \code{TRUE} when
\code{survival} or \code{paired} is set to \code{TRUE}.}

\item{seed.cl}{An integer specifying the seed for randomization;
if not provided, the default is 1234.}

\item{robust}{indicating whether robust fitting should be used.
Default is TRUE, see \link{eBayes}.}

\item{trend}{indicating whether to include trend fitting in the
differential expression analysis. Default is TRUE. see \link{eBayes}.}

\item{permutating.group}{Logical, If \code{TRUE}, the permutation for
calculating the null distribution is performed by permuting the target
group only specified in \code{group.name}. If FALSE, the entire
\code{meta.info} will be permuted (recommended to be set to FALSE).}
}
\value{
A list of class \code{"list"} with the following elements:
\item{data}{The original data matrix.}
\item{B}{The number of bootstrap samples used.}
\item{d}{Differential expression statistics for each feature.}
\item{logfc}{Log-fold change values between groups.}
\item{pvalue}{P-values computed based on the permutation samples.}
\item{FDR}{False discovery rate estimates.}
\item{a1}{Optimized parameter used in differential expression ranking.}
\item{a2}{Optimized parameter used in differential expression ranking.}
\item{k}{Top list size used for ranking.}
\item{corrected.logfc}{Corrected log-fold change values, if applicable.}
\item{q_values}{Estimated q-values using the \code{qvalue} package.}
\item{BH.pvalue}{Benjamini-Hochberg adjusted p-values.}
}
\description{
The \code{LimROTS} function employs a reproducibility-optimized test statistic
utilising the limma and ROTS methodology to simulate complex experimental
designs.
}
\details{
The \strong{LimROTS} approach initially uses the
\link{limma} package to simulate the intensity data of proteins and
metabolites. A linear model is subsequently fitted using the design matrix.
Empirical Bayes variance shrinking is then implemented. To obtain the
moderated t-statistics, the adjusted standard error
\eqn{SEpost = √(s2.post)
\times unscaled SD} for each feature is computed, along with the regression
coefficient for each feature (indicating the impact of variations in the
experimental settings). The \link[ROTS]{ROTS} approach establishes optimality
based on the largest overlap of top-ranked features within group-preserving
bootstrap datasets, Finally based on the optimized parameters
\eqn{\alpha1} and
\eqn{\alpha2} this equation used to calculates the final statistics:
\deqn{t_{\alpha}(g) = \frac{\beta}{\alpha1 + \alpha2 \times SEpost}}where
\eqn{t_{\alpha}(g)} is the final statistics for each feature,
\eqn{\beta} is the coefficient, and SEpost is the the adjusted
standard error. LimROTS generates p-values from permutation samples
using the implementation available in
\link{qvalue} package, along with internal implementation of FDR
adapted from ROTS package. Additionally, the qvalue package is used
to calculate q-values, were the proportion of true null p-values is
set to the bootstrap method \link{pi0est}. We recommend using
permutation-derived p-values and qvalues.
}
\examples{
# Example usage:

data <- data.frame(matrix(rnorm(500), nrow = 100, ncol = 10))
# Simulated data
meta.info <- data.frame(
    group = factor(rep(1:2, each = 5)),
    row.names = colnames(data)
)
formula.str <- "~ 0 + group"
result <- LimROTS(data,
    meta.info = meta.info, group.name = "group",
    formula.str = formula.str, B = 10
)

}
\references{
Ritchie, M.E., Phipson, B., Wu, D., Hu, Y., Law, C.W., Shi, W., and Smyth,
G.K. (2015). limma powers differential expression analyses for
RNA-sequencing and microarray studies. Nucleic Acids Research 43(7), e47

Suomi T, Seyednasrollah F, Jaakkola M, Faux T, Elo L (2017). “ROTS: An
R package for reproducibility-optimized statistical testing.
” \emph{PLoS computational biology}, \emph{13}(5), e1005562.
\url{doi:10.1371/journal.pcbi.1005562}
\url{https://doi.org/10.1371/journal.pcbi.1005562},
\url{http://www.ncbi.nlm.nih.gov/pubmed/28542205}

Elo LL, Filen S, Lahesmaa R, Aittokallio T. Reproducibility-optimized test
statistic for ranking genes in microarray studies.
IEEE/ACM Trans Comput Biol Bioinform. 2008;5(3):423-431.
\url{doi:10.1109/tcbb.2007.1078}
}
