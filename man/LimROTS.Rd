% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/LimROTS.r
\name{LimROTS}
\alias{LimROTS}
\title{LimROTS: An Extension of the ROTS Method with Limma Integration}
\usage{
LimROTS(
  x,
  B = 1000,
  K = NULL,
  a1 = NULL,
  a2 = NULL,
  log = TRUE,
  progress = FALSE,
  verbose = TRUE,
  meta.info = NULL,
  cluster = NULL,
  group.name = NULL,
  formula.str = NULL,
  survival = FALSE,
  paired = FALSE,
  n.ROTS = FALSE,
  seed.cl = 1234,
  robust = TRUE,
  trend = TRUE
)
}
\arguments{
\item{x}{A \code{SummarizedExperiment} object or a matrix where rows represent features (e.g., genes, proteins) and columns represent samples. The values should be log-transformed.}

\item{B}{An integer specifying the number of bootstrap iterations. Default is 1000.}

\item{K}{An optional integer representing the top list size for ranking. If not specified, it is set to one-fourth of the number of features.}

\item{a1}{Optional numeric value used in the optimization process. If defined by the user, no optimization occurs.}

\item{a2}{Optional numeric value used in the optimization process. If defined by the user, no optimization occurs.}

\item{log}{Logical, indicating whether the data is already log-transformed. Default is \code{TRUE}.}

\item{progress}{Logical, indicating whether to display a progress bar during bootstrap sampling. Default is \code{FALSE}.}

\item{verbose}{Logical, indicating whether to display messages during the function's execution. Default is \code{TRUE}.}

\item{meta.info}{A data frame containing sample-level metadata, where each row corresponds to a sample. It should include the grouping variable specified in \code{group.name}. If \code{x} is a \code{SummarizedExperiment} object, \code{meta.info} must be a vector of the metadata needed for the model to run and can be retrieved using \code{colData()}.}

\item{cluster}{A parallel cluster object for distributed computation, e.g., created by \code{makeCluster()}. Default is 2.}

\item{group.name}{A string specifying the column in \code{meta.info} that represents the groups or conditions for comparison.}

\item{formula.str}{A formula string used when covariates are present in meta.info for modeling. It should include "~ 0 + ..." to exclude the intercept from the model.}

\item{survival}{Logical, indicating whether to enable survival analysis. If \code{TRUE}, then \code{meta.info} should contain \code{time} and \code{event} columns.}

\item{paired}{Logical, indicating whether the data represent paired samples. Default is \code{FALSE}.}

\item{n.ROTS}{Logical. If \code{TRUE}, all parameters related to \code{LimROTS} will be ignored, and the original \code{ROTS} analysis will run. This must be \code{TRUE} when \code{survival} or \code{paired} is set to \code{TRUE}.}

\item{seed.cl}{An integer specifying the seed for randomization; if not provided, the default is 1234.}

\item{robust}{indicating whether robust fitting should be used. Default is TRUE, see \link{eBayes}.}

\item{trend}{indicating whether to include trend fitting in the differential expression analysis. Default is TRUE. see \link{eBayes}.}
}
\value{
A list of class \code{"list"} with the following elements:
\item{data}{The original data matrix.}
\item{B}{The number of bootstrap samples used.}
\item{d}{Differential expression statistics for each feature.}
\item{logfc}{Log-fold change values between groups.}
\item{pvalue}{P-values computed based on the permutation samples.}
\item{FDR}{False discovery rate estimates.}
\item{a1}{Optimized parameter used in differential expression ranking.}
\item{a2}{Optimized parameter used in differential expression ranking.}
\item{k}{Top list size used for ranking.}
\item{corrected.logfc}{Corrected log-fold change values, if applicable.}
\item{q_values}{Estimated q-values using the \code{qvalue} package.}
\item{BH.pvalue}{Benjamini-Hochberg adjusted p-values.}
}
\description{
The \code{LimROTS} function employs a reproducibility-optimized test statistic utilising the limma and ROTS methodology to simulate complex experimental designs.
}
\details{
Differential expression analysis is a prevalent method utilised in the examination of diverse biological data.
The reproducibility-optimized test statistic (ROTS) modifies a t-statistic based on the data's intrinsic characteristics and ranks features according to their statistical significance for differential expression between two or more groups, as shown by the f-statistic.
Focussing on proteomics and metabolomics, the current ROTS implementation cannot account for technical or biological covariates such as MS batches or gender differences among the samples.
Consequently, we developed LimROTS, which employs a reproducibility-optimized test statistic utilising the limma methodology to simulate complex experimental designs.
}
\examples{
# Example usage:

data <- data.frame(matrix(rnorm(500), nrow = 100, ncol = 10)) # Simulated data
meta.info <- data.frame(group = factor(rep(1:2, each = 5)), row.names = colnames(data))
formula.str <- "~ 0 + group"
result <- LimROTS(data, meta.info = meta.info, group.name = "group",
                                formula.str = formula.str, B = 10)

}
\references{
Ritchie, M.E., Phipson, B., Wu, D., Hu, Y., Law, C.W., Shi, W., and Smyth, G.K. (2015). limma powers differential
expression analyses for RNA-sequencing and microarray studies. Nucleic Acids Research 43(7), e47

Suomi T, Seyednasrollah F, Jaakkola M, Faux T, Elo L (2017). “ROTS: An R package for reproducibility-optimized
statistical testing.” \emph{PLoS computational biology}, \emph{13}(5), e1005562. \url{doi:10.1371/journal.pcbi.1005562}
\url{https://doi.org/10.1371/journal.pcbi.1005562}, \url{http://www.ncbi.nlm.nih.gov/pubmed/28542205}
}
