% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/LimROTS.r
\name{LimROTS}
\alias{LimROTS}
\title{LimROTS: An Extension of the ROTS Method with Limma Integration}
\usage{
LimROTS(
  x,
  B = 1000,
  K = NULL,
  a1 = NULL,
  a2 = NULL,
  log = TRUE,
  progress = FALSE,
  verbose = TRUE,
  meta.info = NULL,
  cluster = NULL,
  group.name = NULL,
  formula.str = NULL,
  survival = FALSE,
  paired = FALSE,
  n.ROTS = FALSE,
  seed.cl = 1234,
  robust = TRUE,
  trend = TRUE
)
}
\arguments{
\item{x}{A matrix where rows represent features (e.g., genes, proteins), and columns represent samples.
The values should be log-transformed \code{log}, or a SummarizedExperiment object.}

\item{B}{An integer specifying the number of bootstrap iterations. Default is 1000.}

\item{K}{An optional integer representing the top list size for ranking. If not specified, it is set to one-fourth of the number of features.}

\item{a1}{Optional numeric value used in the optimization process.}

\item{a2}{Optional numeric value used in the optimization process.}

\item{log}{Logical, indicating whether the data is already log-transformed. Default is TRUE.}

\item{progress}{Logical, indicating whether to display a progress bar during bootstrap sampling. Default is FALSE.}

\item{verbose}{Logical, indicating whether to display messages during the function's execution. Default is TRUE.}

\item{meta.info}{A data frame containing sample-level metadata, where each row corresponds to a sample. It should include the grouping variable specified in \code{group.name}.}

\item{cluster}{A parallel cluster object for distributed computation, e.g., created by \code{makeCluster()}. Default is NULL.}

\item{group.name}{A string specifying the column in \code{meta.info} that represents the groups or conditions for comparison.}

\item{formula.str}{An optional formula string used when covariates are present in \code{meta.info} for modeling.}

\item{survival}{To enable survival analysis, If TRUE then \code{meta.info} should contains time and event}

\item{paired}{Logical, indicating whether the data represent paired samples. Default is FALSE.}

\item{n.ROTS}{Default is FALSE. If TRUE, all parameters related to LimROTS will be ignored, and the normal ROTS analysis will run.}

\item{seed.cl}{A seed should be set for randomization; if not, the default is 1234}

\item{robust}{Logical, indicating whether robust fitting should be used. Default is TRUE.}

\item{trend}{Logical, indicating whether to include trend fitting in the differential expression analysis. Default is TRUE.}
}
\value{
A list of class \code{"list"} with the following elements:
\item{data}{The original data matrix.}
\item{B}{The number of bootstrap samples used.}
\item{d}{Differential expression statistics for each feature.}
\item{logfc}{Log-fold change values between groups.}
\item{pvalue}{P-values computed based on the permutation samples.}
\item{FDR}{False discovery rate estimates.}
\item{a1}{Optimized parameter used in differential expression ranking.}
\item{a2}{Optimized parameter used in differential expression ranking.}
\item{k}{Top list size used for ranking.}
\item{corrected.logfc}{Corrected log-fold change values, if applicable.}
\item{q_values}{Estimated q-values using the \code{qvalue} package.}
\item{BH.pvalue}{Benjamini-Hochberg adjusted p-values.}
}
\description{
The \code{LimROTS} function performs robust ranking of differential expression statistics for omics data,
incorporating covariates from metadata and optionally integrating survival analysis, paired data, and more.
}
\details{
This function extends the ROTS (Reproducibility Optimized Test Statistic) method by integrating functionality from \code{limma} for differential expression analysis with optional covariates, survival data, and paired samples.
It allows the user to specify additional covariates and models complex experimental designs.
}
\examples{
# Example usage:

data <- data.frame(matrix(rnorm(500), nrow = 100, ncol = 10)) # Simulated data
meta.info <- data.frame(group = factor(rep(1:2, each = 5)), row.names = colnames(data))
formula.str <- "~ 0 + group"
result <- LimROTS(data, meta.info = meta.info, group.name = "group",
                                formula.str = formula.str, B = 10)

}
